<!doctype html>
<html>
	<head></head>
	<body>
		<script>
			function fetchDynastyData(callback) {
				var xhr = new XMLHttpRequest();
				xhr.onreadystatechange = function(data) {
					if (xhr.readyState == 4) {
						if (xhr.status == 200) {
							var data = xhr.responseText;
							callback(data);
						}
						else {
							callback(null);
						}
					}
				};
	
				var url = "http://thedynastyleague.com/dynastyData.xml?_=" + Math.random();
				xhr.open("GET", url, true);
				xhr.send();
			};
		
			function onRequest(request, sender, callback) {
				if (request.action == 'fetchDynastyData') {
					fetchDynastyData(callback);
				}
				else if (request.action == 'getVersion') {
					callback(chrome.app.getDetails().version);
				}
			};
		
			chrome.extension.onRequest.addListener(onRequest);
		</script>
	</body>
</html>